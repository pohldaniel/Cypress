"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.installErrorTransform = exports.transformError = void 0;
const tslib_1 = require("tslib");
const lodash_1 = require("lodash");
const axios_1 = tslib_1.__importDefault(require("axios"));
const transformError = (err) => {
    var _a;
    const { data, status } = axios_1.default.isAxiosError(err) ?
        { data: (_a = err.response) === null || _a === void 0 ? void 0 : _a.data, status: err.status } :
        { data: err.error, status: err.statusCode };
    if ((0, lodash_1.isObject)(data)) {
        const body = JSON.stringify(data, null, 2);
        err.message = [status, body].join('\n\n');
    }
    err.isApiError = true;
    throw err;
};
exports.transformError = transformError;
const installErrorTransform = (axios) => {
    axios.interceptors.response.use(undefined, exports.transformError);
};
exports.installErrorTransform = installErrorTransform;
